<script>

document.addEventListener("DOMContentLoaded", () => {

  const username = localStorage.getItem("username");
  const selectedMode = localStorage.getItem("selectedMode");

  /* ðŸ” Protection */
  if (!username || !selectedMode) {
    window.location.replace("index.html");
    return;
  }

  /* ðŸ‘¤ Affichage joueur */
  document.getElementById("usernameDisplay").textContent = username;

  if (typeof updateLevelUI === "function") {
    updateLevelUI();
  }

  loadCategories(selectedMode);

});


/* =========================
   ðŸ“‚ CHARGEMENT CATÃ‰GORIES
========================= */
function loadCategories(mode) {

  const grid = document.getElementById("categoryGrid");
  const title = document.getElementById("categoryTitle");

  let categories = [];

  if (mode === "geo") {

    title.textContent = "ðŸŒ CatÃ©gories GÃ©o-Quiz";

    categories = [
      { name: "Capitales du monde", type: "capitales" },
      { name: "Pays & Drapeaux", type: "drapeaux" },
      { name: "Continents", type: "continents" },
      { name: "Mers & OcÃ©ans", type: "mers" },
      { name: "Relief & Montagnes", type: "relief" }
    ];

  } else if (mode === "histo") {

    title.textContent = "ðŸ“œ CatÃ©gories Histo-Quiz";

    categories = [
      { name: "AntiquitÃ©", type: "antiquite" },
      { name: "Moyen Ã‚ge", type: "moyen_age" },
      { name: "RÃ©volution FranÃ§aise", type: "revolution" },
      { name: "Guerres Mondiales", type: "guerres" },
      { name: "Civilisations", type: "civilisations" }
    ];
  }

  grid.innerHTML = "";

  categories.forEach(cat => {
    const card = document.createElement("div");
    card.className = "category-card";
    card.innerHTML = `<h3>${cat.name}</h3>`;
    card.addEventListener("click", () => selectCategory(cat.type));
    grid.appendChild(card);
  });
}


/* =========================
   ðŸŽ® SÃ‰LECTION CATÃ‰GORIE
========================= */
function selectCategory(category) {

  localStorage.setItem("selectedCategory", category);

  const container = document.getElementById("themesContainer");

  container.innerHTML = `
    <h3>Choisis une difficultÃ©</h3>
    <div class="theme-grid">
      <button class="main-btn" onclick="startQuiz('facile')">Facile</button>
      <button class="main-btn" onclick="startQuiz('moyen')">Moyen</button>
      <button class="main-btn" onclick="startQuiz('difficile')">Difficile</button>
    </div>
  `;
}


/* =========================
   ðŸš€ DÃ‰MARRER QUIZ
========================= */
function startQuiz(theme) {
  localStorage.setItem("selectedTheme", theme);
  window.location.href = "quiz.html";
}


/* =========================
   â¬… RETOUR
========================= */
function goBack() {
  window.location.href = "menu.html";
}

</script>